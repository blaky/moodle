YUI.add("moodle-tool_capability-search",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)};n.prototype={form:null,select:null,selectoptions:{},input:null,button:null,lastsearch:null,initializer:function(){this.form=e.one("#capability-overview-form"),this.select=this.form.one("select[data-search=capability]"),this.select.setStyle("minWidth",this.select.get("offsetWidth")),this.select.get("options").each(function(e){var t=e.get("value");this.selectoptions[t]=e},this),this.button=this.form.all("input[type=submit]"),this.lastsearch=this.form.one("input[name=search]");var t=e.Node.create('<div id="capabilitysearchui"></div>'),n=e.Node.create('<label for="capabilitysearch">'+this.get("strsearch")+"</label>");this.input=e.Node.create('<input type="text" id="capabilitysearch" />'),t.append(n).append(this.input),this.select.insert(t,"before"),this.input.on("keyup",this.typed,this),this.select.on("change",this.validate,this),this.lastsearch&&(this.input.set("value",this.lastsearch.get("value")),this.typed(),this.select.one("option[selected]")&&this.select.set("scrollTop",this.select.one("option[selected]").get("getX"))),this.validate()},validate:function(){this.button.set("disabled",this.select.get("value")==="")},typed:function(){var e=this.input.get("value"),t=0,n=null,r;this.lastsearch&&this.lastsearch.set("value",e),this.select.all("option").remove();for(r in this.selectoptions)r.indexOf(e)>=0&&(t++,n=this.selectoptions[r],this.select.append(this.selectoptions[r]));t===0?this.input.addClass("error"):(this.input.removeClass("error"),t===1&&n.set("selected",!0)),this.validate()}},e.extend(n,e.Base,n.prototype,{NAME:"tool_capability-search",ATTRS:{strsearch:{}}}),M.tool_capability=M.tool_capability||{},M.tool_capability.scroll_header=function(){e.on("scroll",function(){var t=e.one("table.comparisontable"),n=t.ancestor(),r=window.scrollY,i=t.get("offsetTop"),s=t.one("tr.lastrow").get("offsetTop"),o=e.one("#clone"),u=e.one("body").getComputedStyle("background-color");if(r>i&&r<s){if(!o){var a=0;e.all("header").each(function(e){e.getComputedStyle("position")=="fixed"&&(a=e.getComputedStyle("height"))}),o=t.cloneNode(!0),o.setAttribute("id","clone"),o.setStyles({position:"fixed","margin-top":a,"pointer-events":"none",top:0}),o.one("thead tr").setStyle("height","120"),o.setStyle("width",t.getComputedStyle("width")),n.append(o),o.setStyle("visibility","hidden"),o.one("thead").setStyles({visibility:"visible","background-color":u,"pointer-events":"auto",outline:"1px solid "+u})}}else o&&(o.remove(),o=null);o&&o.setStyle("left",t.getDOMNode().getBoundingClientRect().left)})},M.tool_capability.init_capability_search=function(e){new n(e),M.tool_capability.scroll_header()}},"@VERSION@",{requires:["base","node"]});
